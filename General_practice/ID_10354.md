Most profitable company
=======================

Question
--------
1. Find the 3 most profitable companies
2. expected result : company | profits
3. sort the result by profits in descending order

Table
-----
<pre>
<code>
+----------------------------------+</br>
|company|sector|industry|..|profits|
+----------------------------------+
</code>
</pre>

### Approach
1. Calculate the profits of each company
2. Order by profits
3. Get the most profitable companies

### Code
<pre>
<code>
SELECT company, profits
FROM (SELECT company, SUM(profits) AS profits
      FROM forbes_global_2010_2014
      GROUP BY company) sub
ORDER BY profits DESC
LIMIT 3
</code>
</pre>

I got each of company's profit. I used SUM() in case they have duplicate company that's why I groupby company. 

### Improvement
<pre>
<code>
SELECT company, profits,
        DENSE_RANK() OVER(ORDER BY profits DESC) as rnk
FROM
  (SELECT company, profits
  FROM
    (SELECT company, SUM(profits) AS profits
    FROM forbes_global_2010_2014
    GROUP BY company) sub ) sub_2
 WHERE rnk <= 3
</code>
</pre>
